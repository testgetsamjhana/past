(this.$WP=this.$WP||[]).push(["1iyqcw",(e,t)=>{"use strict";var r,o,i,n,l,a,s,u,p,c,d,v=e=>e.photo&&e.photo.photoSizes[e.photo.photoSizes.length-1]?e.photo.photoSizes[e.photo.photoSizes.length-1]:null,f=e=>[e.owner||e.userProfile,...(e.collaborators||[]).map((e=>e.user))].filter(Boolean),m=(e,t)=>f(e).some((e=>e.isMe||e.userId&&e.userId===t||e.id&&e.id===t)),y=e=>{var t;return null!=(t=e.owner)&&t.isMe?"OWNER":e&&m(e)?"COLLABORATOR":"PUBLIC"},h=(e,t,r,o)=>{var i=f(e);if(i=i.slice(0,t),r>0){var n=0;i=i.filter((e=>(n=e.displayName.length+n)<r))}return o&&(i=i.reverse()),i},P=(e,t)=>[...t||[]].sort(((e,t)=>e.created>t.created?1:-1)),T=e=>{var t;return null==e||null==(t=e.owner)?void 0:t.isMe},_=e=>e.owner&&e.owner.isMe?"OWNER":m(e)?"COLLABORATOR":"VIEWER",I=(e,t)=>(e.items||[]).find((e=>{var r,o,i,n,l,a=e.reference&&e.reference.type&&e.reference.type.toLowerCase(),s=null==(r=e.reference)?void 0:r.id,u=t.type.toLowerCase(),p=t.id.toString(),c="originalObject"in t&&(null==(o=t.originalObject)||null==(i=o.type)?void 0:i.toLowerCase()),d="originalObject"in t&&(null==(n=t.originalObject)||null==(l=n.id)?void 0:l.toString());return a===u&&s===p||a===c&&s===d})),O=(e,t)=>{var r=I(e,t);return r?r.id:null},w={locationinformation:"location",attractionproductinformation:"attractionProduct",forumpost:"post",tripitem:"savesItem",linkpost:"link",linkpost_linkpostv2:"link",photo:"photo",video:"video",review:"review",repost:"repost",trip:"bundleSave",tripnotes_tripnote:"note"},b={locationinformation:"LOCATION",attractionproductinformation:"ATTRACTIONPRODUCT",forumpost:"POST",tripitem:"SAVESITEM",linkpost:"LINK",photo:"PHOTO",video:"VIDEO",review:"REVIEW",repost:"REPOST",trip:"TRIPCONTENT"},g=e=>({statQuery:e}),S=e=>w[e.toLowerCase()],R=e=>b[e.toLowerCase()],L=["LocationInformation","AttractionProductInformation","ForumPost","LinkPost","LinkPost_LinkPostV2","Review","Photo","Video","Repost","Trip","TripNotes_TripNote"],k=e=>{switch(e.__typename){case"AttractionProductInformation":case"LocationInformation":return[e];case"Photo":case"Review":return[e.location];case"Video":return e.orderedLocations;default:return[]}},j=(e,t)=>{if(!e)return null;var r=(e=>{var t,r,o,i,n,l;return null!=(t=null!=(r=null!=(o=null!=(i=null!=(n=null!=(l=e.locationId)?l:e.attractionProductId)?n:e.postId)?i:e.repostId)?o:e.linkPostId)?r:e.id)?t:void 0})(e),o=e.__typename?S(e.__typename):null;if(null!=r&&null!=o){if(L.includes(e.__typename))return{type:o,id:r};var i={id:e.reference.id,type:"attractionproduct"===e.reference.type?"attractionProduct":e.reference.type};if("TripItem"===e.__typename&&e.reference&&e.reference.id&&e.reference.type)return t&&"note"!==i.type?i:{type:o,id:r,originalObject:i}}return null},C=e=>({id:`${e.id}`,type:e.type}),A=(e,t,r)=>`/Trips/${e}${t?`?itemId=${t}`:""}${r?`#/Tab/${r}`:""}`,E=e=>{var[,t,r]=e.split("/");return"Tab"!==t?null:Object.values(c).includes(r)?r:null},F=e=>{var t=d[e.type];return t?{...e,query:t.statQuery,variables:{ids:[e.id]}}:null},N=e=>{var t,r;return["LinkPost","Photo","Review","Video"].includes(null==e||null==(t=e.object)||null==(r=t.repostedObject)?void 0:r.__typename)},V=(e,t)=>{if("_blank"===t){var r=window.open("about:blank",t);return()=>{null!=r&&(r.location=e)}}return()=>{window.open(e,t)}};function z(e,t){return e.reduce(((e,r)=>(t(r)?e[0].push(r):e[1].push(r),e)),[[],[]])}var B=e=>{if(!("__typename"in e))return[];if("LinkPost_LinkPostV2"===e.__typename){var t,r,o=null!=(t=null==(r=e.preview)?void 0:r.media)?t:[];if(!o.length)return[];var i,n,l,a=o.reduce(((e,t)=>t&&t.object?[...e,t]:e),[]).sort(((e,t)=>t.id-e.id)),[s,u]=z(a,(e=>"LinkPreview_PhotoRefV2"===e.__typename));if(s.length)return null!=(i=null==(n=s[0])||null==(l=n.object)?void 0:l.photoSizes)?i:[];if(u.length)return[u[0].object]}if("LinkPost"===e.__typename){var p=e.preview&&e.preview.media||[];if(0===p.length)return[];var c,d,v=e=>{var t;return null!=(t="Photo"===e.__typename?e.photoId:e.previewId)?t:0},f=p.filter(Boolean).sort(((e,t)=>v(t)-v(e))),[m,y]=z(f,(e=>"Photo"===(null==e?void 0:e.__typename)));if(m.length)return null!=(c=null==(d=m[0])?void 0:d.photoSizes)?c:[];if(y.length)return[y[0]]}return[]};return[()=>{d=Object.freeze({location:g(r),attractionProduct:g(o),post:g(i),savesItem:g(n),link:g(l),review:g(a),photo:g(s),video:g(u),repost:g(p)}),e({buildPublicTripShareUrl:A,getCommentsForDisplay:P,getItemByReference:I,getItemIdByReference:O,getPhotoSizesForLinkPost:B,getQueryReferenceTypeFromObjectType:R,getReferenceTypeFromObjectType:S,getTripCoverPhoto:v,getTripPageTabFromFragment:E,getTripUsers:f,getTripUsersForDisplay:h,isOwner:T,isRepostSaveable:N,isTripUser:m,locationsForItem:k,objectStatisticQuery:F,toReference:C,toSavesObject:j,userRelation:_,userTypeFromTrip:y,windowOpener:V})},[e=>(r=e.LocationStatistics,o=e.AttractionStatistics,i=e.ForumStatistics,n=e.TripItemStatistics,l=e.LinkPostStatistics,a=e.ReviewStatistics,s=e.PhotoStatistics,u=e.VideoStatistics,p=e.RepostStatistics),e=>c=e.TRIP_PAGE_TAB_OPTIONS]]},["ag9b0s","3309mt"]]);
