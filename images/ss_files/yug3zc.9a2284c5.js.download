(this.$WP=this.$WP||[]).push(["yug3zc",(e,i)=>{"use strict";var t,a,s,o,l,n,r,d,p,h,g,u,m,c,v,b,y,D,N,O,T,f,I,G,_,w,S,P,E,C,k,R,A,H,M,x,L,z,q,B,U,j,F,V=e=>{L().dispatch(z.page.hotels.setGoogleOneTapOpen(e))},K=({mutation:e,variables:i,onCompleted:t,className:a,children:s,textInputIsValid:o})=>w(I,{query:e,children:({executeMutation:e})=>w("form",{className:a,onSubmit:a=>{a.preventDefault&&a.preventDefault(),o()&&e(i).then((({data:e})=>{t&&t(e)}))},children:s})}),Q={__key:0x78187f1ed93b,id:"78187f1ed93b36379ac28f572f118122",loc:{},definitions:[]},J={__key:22284245845108,id:"1444748ec4743acae16c5bcbca3f3b92",loc:{},definitions:[]},W="homePromptDismissed",Y=["CheapFlightsSearchResults","CheapFlightsSearchDeals","MobileCheapFlightsSearchResults","MobileCheapFlightsSearchDeals","OptimusHotelCheckout","OptimusSubscriptionCheckout"],$=e=>{var{localize:i}=b(),s=O("mobile_web"),{params:o}=_(),{newPlusSubscriber:l=!1}=o,n={bottom:"0"},[r,d]=t({type:"location_id",value:"1",displayValue:""}),[p,h]=t(""),[g,u]=t(!1),m=e=>{h(e)},I=e=>{d(e),h(e.value)},P=s?"QjdMj":"JjknH",E=s?"HgGJN":"IEBQA",C={hometown:r.value||null,userId:e.userId},k=i=>{D({module:"Home_Location_Prompt",action:i,context:e.servlet||"unknown"})};return a((()=>{if(e.ipGeoId&&e.ipGeoId>1&&e.ipGeoNameAndParentName&&""!==e.ipGeoNameAndParentName){var i={type:"location_id",value:e.ipGeoId.toString(),displayValue:e.ipGeoNameAndParentName};d(i),h(i.value)}}),[e.ipGeoId,e.ipGeoNameAndParentName]),w(G,{query:J,variables:{userId:e.userId},children:({fetching:t,data:a})=>{var o,d;return t||(i=>{var t,a,s,o,n=!O("home_location_prompt_master"),r=null==i||null==(t=i.memberProfile)||null==(a=t.hometown)?void 0:a.locationId,d=Date.now()-((null==i||null==(s=i.insightProfile)||null==(o=s.uiCardsState)?void 0:o.timestamp)||0)<864e5,p=y.get(W),h=Y.includes(e.servlet);return l||e.isInterstitialOpen||n||r||d||p||h})(a)?null:(g||(k("Shown_Prompt"),u(!0)),e.onShown(),w(B,{variables:C,onCompleted:i=>{var t;"OK"===(null==i||null==(t=i.updateMemberProfile)?void 0:t.status)&&(k("Change_Location"),e.onComplete(!0))},textInputIsValid:()=>r&&""!==r.value&&r.value===p,mutation:Q,children:S("div",{className:c("qrKQS D C z",P),style:n,children:[w("span",{className:"OBuqK",children:null!=a&&null!=(o=a.memberProfile)&&o.avatar?w(T,{photo:null==a||null==(d=a.memberProfile)?void 0:d.avatar}):w(f,{name:"member",className:"MOOfE"})}),w(v,{colorVariant:"TA_GRAY_3",onClick:()=>{y.set(W,!0),k("Closed_Prompt"),e.onDismiss()}}),S("div",{className:E,children:[w("p",{className:"uhaFN",children:i("I_live_in")}),w("p",{className:"mSHxy",children:i("home_location_things_near_you")}),S("div",{className:"Pdntt",children:[w("div",{className:"fzeJB",children:w(N,{className:"igiwF",selectedLocation:r,selectionChanged:I,textInputChanged:m,iconType:"map-pin-fill",mode:"cities",includeWorld:!1,resultsAbove:s,max:s?4:8})}),w("button",{className:"tvQbB",children:w(f,{name:"arrow-right",className:"uYaJY"})})]})]})]})}))}})},X=[40185,40600],Z=({dismiss:e,props:i,onGoogleOneTapDismiss:s,onGoogleOneTapTriggerNext:o})=>{var[n,r]=t(!i.delayOneTap);return a((()=>{var e;return i.delayOneTap&&(e=setTimeout((()=>{r(!0)}),2e4)),()=>clearTimeout(e)}),[i.delayOneTap]),n?w(H,{children:w(l,{children:w(j,{onDismiss:()=>{e(),s()},onShow:()=>V(!0),triggerNext:o,servletName:i.servlet})})}):null},ee=e=>{var i=p();return i.fetching?null:w(ie,{...e,hardGateEligibility:i})},ie=e=>{var{isDelayVariant:i,isBlockVariant:t,fetching:o}=E(),l=s(x,[]),n=h(e.hardGateEligibility,l),r=!!M();return a((()=>{r||n()}),[n,r]),w(q,{...e,blockOneTap:t,delayOneTap:i,fetchingOneTapUpdates:o,hardGateImpressionKey:l})};return[()=>{K.defaultProps={onCompleted:()=>{},className:"",children:null},B=K,U=r(((e,i)=>{var t=i("/data/1.0/homelocation/ipGeoInfo");return()=>{var i=t&&t.get().data;return{servlet:e.meta.initialServletName,userId:e.auth.loggedInUserId,viewportCategory:e.meta.device.viewportCategory,ipGeoId:null==i?void 0:i.ipGeoId,ipGeoNameAndParentName:null==i?void 0:i.ipGeoNameAndParentName,isInterstitialOpen:e.page.isInterstitialOpen}}}))($),j=n((()=>i("1j3bsm"))),q=class extends o{constructor(e){super(e),this.onGoogleOneTapDismiss=()=>{k(this.props.sessionId),V(!1)},this.onGoogleOneTapTriggerNext=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationDismiss=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationComplete=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationShown=()=>{m("home-location-prompt").emit("shown")},this.onRegistrationOverlayShown=(e,i)=>{X.includes(i)||this.setState({dialogsDisabled:!0})},this.setupRegDialog=()=>{if(m("Onboarding").on("loginSuccess",this.disableDialog),m("registration-overlay").on("shown",this.onRegistrationOverlayShown),m("FlightList").on("AirwatchInterstitialOpened",this.disableDialog),R.includes(this.props.servlet)||"ShowUserReviews"===this.props.servlet||"MobileShowUserReviews"===this.props.servlet){if(m("DatePicker").on("clicked",this.disableDialog),m("global-nav").on("sidebarOpened",this.disableDialog),m("hotels-sort-filter-entry").on("openSort",this.disableDialog),m("hotels-sort-filter-entry").on("openFilters",this.disableDialog),m("hr-persistent-footer").on("show",this.disableDialog),m("h-map").on("open-trigger-clicked",this.disableDialog),m("h-map").on("toggle-trigger-clicked",this.disableDialog),m("rooms-guests").on("popped",this.disableDialog),this.props.defaultDates&&!u.wasDismissed(this.props.detailPage)&&"MOBILE"===this.props.viewportCategory)return m("rooms-guests").on("firstUserUpdate",this.enableDialog),m("picker-autoadvance").on("flow-complete",this.enableDialog),void m("pop-calendar").on("dismissed",this.enableDialog);m("responsiveStayDates").on("calendarInteracted",this.disableDialog)}this.enableDialog()},this.initialDialogType=void 0,this.decideInitialDialogType=e=>{var i=!this.props.isMember&&!e,t=this.props.isMember,a="NONE";return this.props.hardGateEligibility.showHardGate?a="HARD_GATE":i?a="GOOGLE_ONETAP":t&&(a="HOME_LOCATION_PROMPT"),a},this.enableDialog=()=>{"NONE"===this.state.dialogType&&this.setState({dialogType:this.initialDialogType})},this.disableDialog=()=>{"NONE"!==this.state.dialogType&&this.setState({dialogType:"NONE",dialogsDisabled:!0})},this.state={dialogType:"NONE",dialogsDisabled:!1,suppressRegDialog:!0}}componentDidMount(){var e=A(this.props.sessionId);this.initialDialogType=this.decideInitialDialogType(e),"NONE"!==this.initialDialogType?(this.setupRegDialog(),this.setState({suppressRegDialog:e&&"HARD_GATE"!==this.initialDialogType})):m("reg_dialog").emit("all_dismissed")}componentDidUpdate(e){!e.isMember&&this.props.isMember&&this.disableDialog()}render(){var{dialogsDisabled:e,dialogType:i,suppressRegDialog:t}=this.state,a=()=>null,s=[],o="registration_dialog";if(e)return null;switch(i){case"GOOGLE_ONETAP":s=["google_one_tap"],a=({dismiss:e})=>w(Z,{dismiss:e,props:this.props,onGoogleOneTapDismiss:this.onGoogleOneTapDismiss,onGoogleOneTapTriggerNext:this.onGoogleOneTapTriggerNext}),o="google_one_tap";break;case"HARD_GATE":s=["hard_gate"],a=({dismiss:e})=>w(g,{eligibility:this.props.hardGateEligibility,impressionKey:this.props.hardGateImpressionKey,children:w(C,{onLogin:e})}),o="hard_gate"}var l=t||this.props.isMember||this.props.isPaywallBlocking||this.props.blockOneTap;return"HOME_LOCATION_PROMPT"===i?S(P,{children:[null,null,w(U,{onDismiss:this.onHomeLocationDismiss,onShown:this.onHomeLocationShown,onComplete:this.onHomeLocationComplete})]}):s.length>0&&!this.props.fetchingOneTapUpdates&&!l?S(P,{children:[null,null,w(d,{factory:a,eventTypes:s,renderKey:o,tier:200})]}):null}},F=r({data:(e,i)=>(U.stage(e,i),()=>{var i;return{isMember:e.auth.isMember,isDatePickerPage:e.page.isDatePickerPage,isPaywallBlocking:e.page.isPaywallBlocking,sessionId:e.tracking.sessionId,viewportCategory:e.meta.device.viewportCategory,servlet:e.meta.initialServletName,defaultDates:!!(e.travelerInfo.hotels||{}).defaultDates,detailPage:!(null==(i=e.page)||!i.detailId)}}),actions:{}})(ee),e("default",F)},[e=>(t=e.useState,a=e.useEffect,s=e.useMemo,o=e.Component,l=e.Suspense,n=e.lazy),e=>r=e.bind,e=>d=e.PopupHierarchyRender,e=>(p=e.useHardGateEligibility,h=e.useHardGateGhostImpression,g=e.HardGateContextProvider),e=>u=e.default,e=>m=e.createRadio,e=>c=e.default,e=>v=e.CloseIcon,e=>b=e.useLocalize,e=>y=e.default,e=>D=e.default,e=>N=e.GeoSelector,e=>O=e.featureIsEnabled,e=>T=e.Avatar,e=>f=e.Icon,e=>(I=e.Mutation,G=e.Query),e=>_=e.useRoute,e=>(w=e.jsx,S=e.jsxs,P=e.Fragment),e=>E=e.useGoogleOneTapUpdates,e=>C=e.default,e=>(k=e.setRegDialogDismissed,R=e.HOTEL_SERVLETS,A=e.shouldSuppressRegistrationDialog),e=>H=e.ErrorBoundary,e=>M=e.useUserId,e=>x=e.uuid,e=>(L=e.getStore,z=e.actions)]]},["1o4yt4","16z5q2","18pymb","igyuz7","losr6p","1bqgab","fkji80","1uzmmz","17thqz","19b9b1","4axon3","1uaudg","skjzuv","dl4tf4","1ybxsm","1mqwhq","fgwvq1","121h32","wsk8ra","cjerkd","cyrz7y","183pm0","52far5","1eww82","45ddp0"]]);
