(this.$WP=this.$WP||[]).push(["avx3a3",(e,t)=>{"use strict";var a,s,n,r,i,o,l,d,u,c,p,g,m,h,v,f,S,y,D,I,b,T,N,E,L,w,_,A,C,k,O,x,q,G,R,P,H,j,U,W,M={seeAllLinks:!1,titles:!1,tagTranslations:!1,maxAccommodations:!1,tooltips:!1},F=(e,t)=>{var a=new Date;a.setDate(a.getDate()+e),t.push(a.getFullYear()),t.push(a.getMonth()+1),t.push(a.getDate())},K=e=>{var{accommodationsByType:t,pageLocations:a,isSearchComplete:s,sponsoredListingData:n,searchKey:r}=e,i=a.reduce(((e,a)=>(e[a.locationName]={crossSells:a.crossSellTypes.map((e=>t[e])),locationName:a.locationName,locationOrder:a.locationOrder},e)),{});return{pageLocations:a,locationMap:i,isSearchComplete:s,sponsoredListingData:n,searchKey:r}},$="hr_xsell_skeleton",z=[10,1e3,1e3,1e3,1e3,1500,1500,1500,2e3,2e3,2e3],B="Will stop polling.";function J(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function X(e){J(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(new Error).stack,new Date(NaN))}function V(e){J(1,arguments);var t=X(e);return!isNaN(t)}function Y(e,t){for(var a=e<0?"-":"",s=Math.abs(e).toString();s.length<t;)s="0"+s;return a+s}function Q(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only ".concat(arguments.length," present"));var a=X(e);if(!V(a))throw new RangeError("Invalid time value");var s=t||{},n=null==s.format?"extended":String(s.format),r=null==s.representation?"complete":String(s.representation);if("extended"!==n&&"basic"!==n)throw new RangeError("format must be 'extended' or 'basic'");if("date"!==r&&"time"!==r&&"complete"!==r)throw new RangeError("representation must be 'date', 'time', or 'complete'");var i="",o="",l="extended"===n?"-":"",d="extended"===n?":":"";if("time"!==r){var u=Y(a.getDate(),2),c=Y(a.getMonth()+1,2),p=Y(a.getFullYear(),4);i="".concat(p).concat(l).concat(c).concat(l).concat(u)}if("date"!==r){var g=a.getTimezoneOffset();if(0!==g){var m=Math.abs(g),h=Y(Math.floor(m/60),2),v=Y(m%60,2),f=g<0?"+":"-";o="".concat(f).concat(h,":").concat(v)}else o="Z";var S=Y(a.getHours(),2),y=Y(a.getMinutes(),2),D=Y(a.getSeconds(),2),I=""===i?"":"T",b=[S,y,D].join(d);i="".concat(i).concat(I).concat(b).concat(o)}return i}var Z=e=>"cg"===e,ee=e=>e&&e.reduce(((e,t)=>(e[t.key]=t.value,e)),{}),te={__key:0xd4ead89c1436,id:"d4ead89c1436b0934c1f3cbe457425c6",loc:{},definitions:[]},ae=[1e3,1e3,1e3,1e3,1500,1500,1500,2e3,2e3,2e3,5e3,1e4];function se(e){var[,t]=s(0),a=n(null),i=n(null),o=n(0),l=n(0),{updateCrossSellEndpointData:d,filters:g}=e,{page:m,params:h}=c(),f=p(),{detailId:I=-1}=h,{hotels:N}=D(),E=b(),L=y(),w=u("meta_absolute_pricing")?"ALL_IN_FULL_STAY":u("meta_all_in_pricing")?"ALL_IN_RATE":"BASE_RATE",_=i.current,A={adults:N&&N.adults||2,rooms:N&&N.rooms||1,checkInDate:null!=N&&N.checkInDate?Q(N.checkInDate,{representation:"date"}):"",checkOutDate:null!=N&&N.checkOutDate?Q(N.checkOutDate,{representation:"date"}):"",childAgesPerRoom:N&&N.childAgesPerRoom,usedDefaultDates:N&&!!N.defaultDates},C=g&&g.zft&&parseInt(g.zft,10),k=null;C&&(k={integerFilters:[{filterType:"MULTI_TAG",values:[C]}]});var O={locationId:I,application:"HOTEL_DETAIL",currencyCode:E,pricingMode:w,sessionId:L,pageviewUid:f,travelInfo:A,requestNumber:l.current,filters:k,route:{page:m,params:h}};i.current=O,S(_&&_.travelInfo,O.travelInfo)||(l.current=0,o.current=0);var[{fetching:x,data:q,error:G}]=T({query:te,variables:O}),R=q&&q.HPS_getWebXSellShelves,P=(({data:e,error:t})=>{var a;return(null==e||null==(a=e.HPS_getWebXSellShelves)?void 0:a.isHacComplete)||!!t})({data:q,error:G})||l.current>=ae.length,H=((e,t)=>{var{accommodationsByType:a,pageLocations:s,isHacComplete:n,searchKey:r}=e||{},i=ee(a),o=n?v.SHOWING:v.LOADING,l=s&&s.reduce(((e,t)=>{var a=[];return t.crossSellTypes.forEach((e=>{var t={};Z(e)&&(t=(e=>{for(var t={},a=function(a){Object.keys(e[a]).forEach((s=>{t[`${s}`]=e[a][s]}))},s=0;s<e.length;s++)a(s);return t})(i[e].accommodations.map((e=>{var t;return e&&(null==(t=e.comparisonGridInfo.availableAmenityKeys)?void 0:t.map((e=>{var t={};return e&&e.tagId&&(t[e.tagId]=e.localizedName),t})))})).flat())),a.push({accommodations:i[e].accommodations.map((t=>t&&((e,t,a)=>{var s,n,r,i,o,l,d,u,c,p,g=(null==(s=e.location)||null==(n=s.reviewSummary)?void 0:n.rating)||0;g&&(g*=10);var m,h=e.location&&{latitude:e.location.latitude,longitude:e.location.longitude},v={id:(null==(r=e.location)?void 0:r.locationId)||0,name:(null==(i=e.location)?void 0:i.name)||"",detailUrl:(null==(o=e.location)?void 0:o.url)||"",numReviews:(null==(l=e.location)||null==(d=l.reviewSummary)?void 0:d.count)||0,bubbleRating:g,geoPoint:h,thumbnail:null==(u=e.location)?void 0:u.thumbnail},f=((e,t)=>{var a,s,n,r,i,o,l,d,u,c,p,g,m,h,v,f,S,y,D,I,b,T,N;if(!Z(t))return null;var E=e.comparisonGridInfo&&e.comparisonGridInfo.nearbyTransportation&&{name:(null==(a=e.comparisonGridInfo.nearbyTransportation)||null==(s=a.location)?void 0:s.name)||"",distance:Number(null==(n=e.comparisonGridInfo.nearbyTransportation)||null==(r=n.distance)?void 0:r.toFixed(1))||0,type:(null==(i=e.comparisonGridInfo.nearbyTransportation)?void 0:i.poiType)||"flights"}||null,L=e.comparisonGridInfo&&{name:(null==(o=e.comparisonGridInfo.nearbyHighlightPoi)||null==(l=o.location)?void 0:l.name)||"",distance:Number(null==(d=e.comparisonGridInfo.nearbyHighlightPoi)||null==(u=d.distance)?void 0:u.toFixed(1))||0,type:(null==(c=e.comparisonGridInfo.nearbyHighlightPoi)?void 0:c.poiType)||"parking"}||null,w=e.comparisonGridInfo&&L&&E&&{name:(null==(p=e.comparisonGridInfo.location)||null==(g=p.neighborhoods)||null==(m=g[0])?void 0:m.name)||(null==(h=e.location)?void 0:h.geoName)||"",nearbyTransportation:E,nearbyPOI:L}||null,_=(null==(v=e.comparisonGridInfo)||null==(f=v.availableAmenityKeys)?void 0:f.map((e=>e&&e.tagId||0)))||[],A=(null==(S=e.comparisonGridInfo)||null==(y=S.reviewSnippets)||null==(D=y.items)?void 0:D.filter((e=>e)).map((e=>{var t,a=e&&e.text||"";return{htmlEscapedText:a=(a=a.replaceAll("￹",'<span class="highlighted">')).replaceAll("￻","</span>"),url:e&&(null==(t=e.reviewUrl)?void 0:t.url)||""}})))||null;return e.comparisonGridInfo&&A&&_&&w&&{availableAmenityKeys:_,accommodationClassTagId:null==(I=e.comparisonGridInfo.location)||null==(b=I.detail)||null==(T=b.starRating)||null==(N=T[0])?void 0:N.tagId,neighborhood:w,reviewSnippets:A}||null})(e,t),S=e.sponsoredListingInfo?{tracking_guid:e.sponsoredListingInfo.trackingGUID,attributionToken:e.sponsoredListingInfo.attributionToken?e.sponsoredListingInfo.attributionToken:void 0}:void 0;null!=(c=e.distance)&&c.distance&&null!=(p=e.distance)&&p.unit&&(m={distance:e.distance.distance,unit:e.distance.unit});var y={location:v,listingKey:e.listingKey||"",displayPrice:e.displayPrice||"",distance:m,localizedDistance:e.localizedDistance||"",sponsoredListingV2:S,hideSPPill:a,popIndexMessage:e.popIndexMessage||""};return Z(t)&&f&&(y.comparisonGridInfo=f),y})(t,e,i[e].hideSponsoredPill))),crossSellType:i[e].crossSellType,placementName:i[e].placementName,isOverallComplete:n,impressionKey:"",tagTranslations:t,updateWithNewData:!0,displayState:o})})),e[t.locationName]={crossSells:a,locationName:t.locationName,locationOrder:t.locationOrder},e}),{});return{pageLocations:s,locationMap:l,isSearchComplete:t,sponsoredListingData:void 0,searchKey:r}})(R,P),j=!x&&!P&&H,U=!x&&!G&&H&&o.current<=l.current;return r((()=>{U&&(j&&(clearTimeout(a.current),a.current=setTimeout((()=>{l.current+=1,t((e=>e+1))}),ae[l.current])),o.current+=1,d(H))}),[l,j,U,o,H,d]),null}var ne={__key:0x5cd49a7df6e0,id:"5cd49a7df6e081fe2b891f6194c96e72",loc:{},definitions:[]};function re(e){var{containerLoadedCallback:t,setUIAssets:a,application:s}=e,n={locationId:e.featuredAccommodation,application:s},[{fetching:i,data:o,error:l}]=T({query:ne,variables:n}),d=(e=>{var{seeAllLinks:t,tagTranslations:a,titles:s,tooltips:n}=e||{},r=ee(t),i={};Object.keys(r||{}).forEach((e=>{r[e]&&(i[e]=r[e].nonCanonicalUrl)}));var o=ee(a),l=ee(s),d=ee(n);return{seeAllLinks:i,tagTranslations:o,titles:l,tooltips:d,maxAccommodations:!1}})(o&&o.HPS_getWebXSellComponents);return r((()=>{!d||l||i||(t(),a(d))}),[i,l,d,a,t]),null}function ie(e){var t="locationPhotoDirectLink"===e.requestCaller,[a,n]=s(!1),i=u("t4b_hr_xsell_sponsored_slot_0_display")&&!t,{didALocationRegister:o,featuredAccommodation:l,xsellConfig:d,setUIAssets:p,filters:g,requestCaller:m,skipOnLoadSearch:h}=e,{page:v}=c(),f="Hotel_Review"===v;r((()=>{f||a||!o||(((e,t,a,s)=>{e&&fetch(((e,t,a)=>{var s=`/data/1.0/crosssellaccommodations/${e}/uiAssets/${t}`,n=new URLSearchParams;a&&n.append("ft",JSON.stringify(a));var r=n.toString();return r?`${s}?${r}`:s})(e,t,s),{method:"GET",header:{"Content-Type":"application/json"},credentials:"same-origin"}).then((e=>{if(e.ok)return e;throw JSON.stringify(e),new Error(e.statusText)})).then((e=>e.json())).then((e=>{a(e)}))})(l,d,p,g),n(!0))}),[a,n,o,l,d,p,g,f]);var S=null;if(!a&&o&&f&&(S=N(j,{featuredAccommodation:l,application:"HOTEL_DETAIL",containerLoadedCallback:()=>(n(!0),null)})),o&&a){var y={configuration:d,featuredAccommodation:l,requestCaller:m||"hotelReview",sponsoredListingsEnabled:i,serverSideSponsoredHotelSelectionEnabled:i,skipOnLoadSearch:h,filters:g};S=f?E(L,{children:[S,N(H,{...y})]}):N(P,{...y})}return S}var oe={seeAllLinks:!1,titles:!1,tagTranslations:!1,maxAccommodations:!1,tooltips:!1},le=()=>{var e,t;if("undefined"==typeof window)return M;var a=l().getState();return(null==a||null==(e=a.page)||null==(t=e.crossSells)?void 0:t.uiAssets)||oe},de=e=>((e,t,a)=>t&&e&&t[e]?t[e]:a)(e,W().titles,N(I,{id:"p13n_you_may_also_like"})),ue=e=>{var t=W(),{tooltips:a}=t;return a&&e&&a[e]||null},ce=e=>{var t=W(),{seeAllLinks:a}=t;return((e,t,a)=>t&&e&&t[e]?t[e]:a)(e,a,null==a?void 0:a.default)};return[()=>{w=class extends a{constructor(e){super(e),M=e.data}render(){return null}},C=i({data:(e,t)=>{var a=t("/data/1.0/crosssellaccommodations/comparisongridcrosssellsuiassets/");return()=>{var{data:e,loading:t}=a.get();return t||!e?{}:{data:e}}},actions:{}})(w),_=class extends a{constructor(e){super(e),this.props.updateCrossSellEndpointData(this.props.data)}render(){return null}},k=i({data:(e,t)=>{var a=t("/data/1.0/crosssellaccommodations/comparisongridcrosssells");return e=>{var{data:t,loading:s}=a.get();return s||!t||e.page.crossSells.updatingResults?{}:{data:K(t)}}},actions:{updateCrossSellEndpointData:o.page.hotelreview.setCrossSellsEndpointResults}})(_),O=k,x={module:$,action:"xsell_show"},q={module:$,action:"xsell_collapse"},G={module:$,action:"xsell_remains_hidden"},R=class{constructor(e=f){this.trackEventAjax=void 0,this.displayStates=void 0,this.previousResults=void 0,this.shouldShowIncompleteResults=void 0,this.calculateDisplayStates=(e,t,a=!1)=>{for(var{accommodationsByType:s,...n}=e,r={},i=Object.keys(s),o=0;o<i.length;o++){var l=i[o],d=s[l],u=!1;this.displayStates[l]||(this.displayStates[l]=v.HIDDEN,u=!0);var c=this.displayStates[l],p=d.accommodations.length>0,g=d.isOverallComplete,m=void 0;if(a){var h=this.shouldShowIncompleteResults[l];m=this.getTimeoutStateTransition(c,g,h)}else m=this.getNextDisplayStateTransition(c,p,g,t,u);m.updateWithNewData&&(this.displayStates[l]=m.displayState),r[l]={...d,...m}}var f={accommodationsByType:r,...n};return this.previousResults=f,f},this.calculateTimeoutStates=()=>this.calculateDisplayStates(this.previousResults,0,!0),this.transition=(e,t)=>({displayState:e,updateWithNewData:t}),this.fromHidden=(e,t,a)=>e?(this.trackEventAjax(x),this.transition(v.SHOWING,!0)):t?(a&&this.trackEventAjax(G),this.transition(v.HIDDEN,!1)):(this.trackEventAjax(x),this.transition(v.LOADING,!0)),this.fromLoading=(e,t)=>e?this.transition(v.SHOWING,!0):t?(this.trackEventAjax(q),this.transition(v.HIDDEN,!0)):this.transition(v.LOADING,!1),this.fromShowing=(e,t,a)=>e?this.transition(v.SHOWING,!0):t?(this.trackEventAjax(q),this.transition(v.HIDDEN,!0)):1===a?this.transition(v.LOADING,!0):this.transition(v.SHOWING,!1),this.getNextDisplayStateTransition=(e,t,a,s,n)=>{switch(e){case v.HIDDEN:return this.fromHidden(t,a,n);case v.LOADING:return this.fromLoading(t,a);default:return this.fromShowing(t,a,s)}},this.getTimeoutStateTransition=(e,t,a=!0)=>{if(e===v.SHOWING){if(t||a)return this.transition(v.SHOWING,!1)}else e===v.LOADING&&this.trackEventAjax(q);return this.transition(v.HIDDEN,e!==v.HIDDEN)},this.trackEventAjax=e,this.displayStates={},this.shouldShowIncompleteResults={n:!0,c:!0,m:!0}}},A=class extends a{constructor(e){super(e),this.displayManager=void 0,this.pollingDelay=void 0,this.pollingTimedOut=()=>{this.props.urlData.requestNumber;var e=this.displayManager.calculateTimeoutStates(),t=K(e);this.props.updateCrossSellEndpointData(t)},this.timerContainer=new m,this.displayManager=new R,this.pollingDelay=z}componentDidMount(){this.props.skipOnLoadSearch||this.fetchCrossSellData()}componentDidUpdate(e){this.urlParamsChanged(e.urlData)&&!this.props.updatingXSellResults&&this.fetchCrossSellData()}urlParamsChanged(e){var t=this.props.urlData;return e.requestNumber!==t.requestNumber||e.stayDates!==t.stayDates||e.guests!==t.guests||e.detailId!==t.detailId||e.configuration!==t.configuration||e.requestCaller!==t.requestCaller||!g(e.filters,t.filters)}fetchCrossSellData(){var{urlData:e}=this.props;(e=>!!(e.detailId&&e.stayDates&&e.guests))(e)?((e,t=1e4)=>Promise.race([fetch(e,{method:"GET",header:{"Content-Type":"application/json"},credentials:"same-origin"}),new Promise(((e,a)=>{setTimeout((()=>a(new Error("timeout"))),t)}))]))(((e,t)=>{var a=new URLSearchParams;if(a.append("rn",String(e.requestNumber)),a.append("stayDates",e.stayDates),a.append("guestInfo",e.guests),a.append("csc",e.configuration),a.append("rc",e.requestCaller),e.sponsoredListingData){var s={...e.sponsoredListingData};delete s.debugData,a.append("sld",JSON.stringify(s))}return e.requestNumber>t.length&&a.append("ifp",""),e.searchKey&&a.append("sk",e.searchKey),e.pageLoadUid&&a.append("puid",e.pageLoadUid),e.paramSeqId&&a.append("paramSeqId",String(e.paramSeqId)),e.filters&&a.append("ft",JSON.stringify(e.filters)),`/data/1.0/crosssellaccommodations/${e.detailId}?${a.toString()}`})(e,this.pollingDelay)).then((e=>{if(e.ok||e.status>=200&&e.status<300)return e;var t=`ResponseStatus: ${e.status} Invalid results from server: ${JSON.stringify(e)}`;return 400===e.status&&(t=`${B} ${t}`),Promise.reject(new Error(t))})).then((e=>e.json())).then((e=>{var t,a=this.displayManager.calculateDisplayStates(e,this.props.urlData.requestNumber);a.sponsoredListingData&&a.sponsoredListingData.debugData&&(t=a.sponsoredListingData.debugData,window.__SP_DEBUG_EVENTS__=window.__SP_DEBUG_EVENTS__||[],t.forEach((e=>window.__SP_DEBUG_EVENTS__.push(e))),globalThis.require("ta/Core/TA.FireEvent").fireEvent("sp_debug_refresh"));var s=K(a);this.props.updateCrossSellEndpointData(s),s.isSearchComplete||this.triggerPoll()})).catch((e=>{var t;null!=e&&null!=(t=e.message)&&t.startsWith(B)||this.triggerPoll()})):JSON.stringify(e)}triggerPoll(){var e={poll:this.props.poll,pollingDelay:this.pollingDelay,requestNumber:this.props.urlData.requestNumber,loading:!1,complete:!1,timedOut:this.pollingTimedOut};JSON.stringify(e),h(e,this.timerContainer)}render(){return null}},P=d(((e,t)=>{var a,s,n,r;return{...t,urlData:(s=e,n=t,r={detailId:n.featuredAccommodation,requestNumber:s.page.crossSells.requestNumber,configuration:n.configuration,requestCaller:n.requestCaller,filters:n.filters},((e,t,a)=>{var s,n,r,i,o,l,d=t.travelerInfo&&t.travelerInfo.hotels;if(d)e.stayDates=d.stayDates,e.guests=d.guests,e.paramSeqId=d.paramSeqId||0;else{var u=[];F(1,u),F(2,u),e.stayDates=u.join("_"),e.guests="1_1",e.paramSeqId=0}e.requestNumber>1&&(e.searchKey=null==t||null==(s=t.page)||null==(n=s.crossSells)||null==(r=n.endpointResults)?void 0:r.searchKey),a.sponsoredListingsEnabled&&(1===e.requestNumber?e.sponsoredListingData={}:e.sponsoredListingData=(null==t||null==(i=t.page)||null==(o=i.crossSells)||null==(l=o.endpointResults)?void 0:l.sponsoredListingData)||{}),t.tracking&&t.tracking.uid&&(e.pageLoadUid=t.tracking.uid)})(r,s,n),r),updatingXSellResults:!(null==(a=e.page.crossSells)||!a.updatingResults)}}),{poll:o.page.hotelreview.crossSellsPoll,updateCrossSellEndpointData:o.page.hotelreview.setCrossSellsEndpointResults})(A),H=d(((e,t)=>({...t})),{updateCrossSellEndpointData:o.page.hotelreview.setCrossSellsEndpointResults})(se),j=d(((e,t)=>({...t})),{setUIAssets:o.page.hotelreview.setUIAssets})(re),U=d(((e,t)=>{var a;return{...t,didALocationRegister:!t.wait&&!(null==(a=e.page.crossSells)||!a.atLeastOneLocationRegistered),featuredAccommodation:e.route.detail||e.page.detailId}}),{setUIAssets:o.page.hotelreview.setUIAssets})(ie),e({ComparisonGridDataLoader:O,HpsCrossSellDataFetcher:H,HpsUiAssetFetcher:j,UiAssetLoader:C,WaitForPageLocation:U,getSeeAllUrlForCrossSellType:ce,getTitleForCrossSellType:de,getTooltipForCrossSellType:ue,getUIAssets:W=le})},[e=>(a=e.Component,s=e.useState,n=e.useRef,r=e.useEffect),e=>i=e.bind,e=>(o=e.actions,l=e.getStore),e=>d=e.connect,e=>u=e.featureIsEnabled,e=>(c=e.useRoute,p=e.usePageviewUid),e=>g=e.default,e=>(m=e.TimerContainer,h=e.setTimer),e=>v=e.DisplayState,e=>f=e.default,e=>S=e.shallowEquals,e=>y=e.useSessionId,e=>D=e.useTravelInfo,e=>(I=e.default,b=e.useCurrency),e=>T=e.useQuery,e=>(N=e.jsx,E=e.jsxs,L=e.Fragment)]]},["1o4yt4","16z5q2","45ddp0","12mj4n","skjzuv","fgwvq1","b5nukb","10l1dx","1o1fcv","4axon3","1t05m6","1al4vi","1etaac","17thqz","1mqwhq","121h32"]]);
