(this.$WP=this.$WP||[]).push(["vk3cpw",(e,r)=>{"use strict";var t,n,o,a,i,l,u,s,c,d,m,p,v,g,f,h,y,D,b;function T(e,r){if(r.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+r.length+" present")}function P(e){T(1,arguments);var r=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===r?new Date(e.getTime()):"number"==typeof e||"[object Number]"===r?new Date(e):("string"!=typeof e&&"[object String]"!==r||"undefined"==typeof console||(new Error).stack,new Date(NaN))}function I(e){T(1,arguments);var r=P(e);return!isNaN(r)}function S(e){if(null===e||!0===e||!1===e)return NaN;var r=Number(e);return isNaN(r)?r:r<0?Math.ceil(r):Math.floor(r)}var k=36e5,C={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},N=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,R=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,w=/^([+-])(\d{2})(?::?(\d{2}))?$/;function O(e,r){T(1,arguments);var t=r||{},n=null==t.additionalDigits?2:S(t.additionalDigits);if(2!==n&&1!==n&&0!==n)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var o,a=A(e);if(a.date){var i=U(a.date,n);o=B(i.restDateString,i.year)}if(isNaN(o)||!o)return new Date(NaN);var l,u=o.getTime(),s=0;if(a.time&&(s=E(a.time),isNaN(s)||null===s))return new Date(NaN);if(!a.timezone){var c=new Date(u+s),d=new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds());return d.setFullYear(c.getUTCFullYear()),d}return l=x(a.timezone),isNaN(l)?new Date(NaN):new Date(u+s+l)}function A(e){var r,t={},n=e.split(C.dateTimeDelimiter);if(n.length>2)return t;if(/:/.test(n[0])?(t.date=null,r=n[0]):(t.date=n[0],r=n[1],C.timeZoneDelimiter.test(t.date)&&(t.date=e.split(C.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){var o=C.timezone.exec(r);o?(t.time=r.replace(o[1],""),t.timezone=o[1]):t.time=r}return t}function U(e,r){var t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:null};var o=n[1]&&parseInt(n[1]),a=n[2]&&parseInt(n[2]);return{year:null==a?o:100*a,restDateString:e.slice((n[1]||n[2]).length)}}function B(e,r){if(null===r)return null;var t=e.match(N);if(!t)return null;var n=!!t[4],o=_(t[1]),a=_(t[2])-1,i=_(t[3]),l=_(t[4]),u=_(t[5])-1;if(n)return function(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}(0,l,u)?function(e,r,t){var n=new Date(0);n.setUTCFullYear(e,0,4);var o=7*(r-1)+t+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+o),n}(r,l,u):new Date(NaN);var s=new Date(0);return function(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(M[r]||(j(e)?29:28))}(r,a,i)&&function(e,r){return r>=1&&r<=(j(e)?366:365)}(r,o)?(s.setUTCFullYear(r,a,Math.max(o,i)),s):new Date(NaN)}function _(e){return e?parseInt(e):1}function E(e){var r=e.match(R);if(!r)return null;var t=L(r[1]),n=L(r[2]),o=L(r[3]);return function(e,r,t){return 24===e?0===r&&0===t:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}(t,n,o)?t*k+6e4*n+1e3*o:NaN}function L(e){return e&&parseFloat(e.replace(",","."))||0}function x(e){if("Z"===e)return 0;var r=e.match(w);if(!r)return 0;var t="+"===r[1]?-1:1,n=parseInt(r[2]),o=r[3]&&parseInt(r[3])||0;return function(e,r){return r>=0&&r<=59}(0,o)?t*(n*k+6e4*o):NaN}var M=[31,null,31,30,31,30,31,31,30,31,30,31];function j(e){return e%400==0||e%4==0&&e%100}var F=[1,1],z=e=>{var[r,t]=F;return{url:e,width:r,height:t}};function K(e){return e.map((e=>{return{id:(r=99999999*Math.random()+3e8,Math.round(r)),photoSizes:[z(e)]};var r}))}function $(e){var{copy:r={},simple:t={},detailed:n={},tracking:{totalNoCurrency:o=0,rate:a}}=e;return{nightlyRate:n.nightlyRate,totalDueToday:n.payAtBookingTotal,totalDueAtStay:n.payAtStayTotal,rawTotalDueToday:n.rawPayAtBookingTotal,totalPrice:n.grandTotal,partnerCurrencyTotalPrice:n.partnerCurrencyGrandTotal,partnerCurrency:r.localizedPartnerCurrency,totalOptimusDiscount:n.optimusDiscountsTotal,totalPriceWithoutOptimusDiscount:n.roomRateTotalBeforeOptimusDiscount,displayPrice:t.displayPrice,rawDisplayPrice:a,priceMode:t.metaDisplayPriceStrategy,referenceRateDisplayDiscount:t.referenceRateDisplayDiscount,referenceRateDisplayPrice:t.referenceRateDisplayPrice,nightlyRateByNumNights:n.nightlyRateByNumNights,subTotal:n.subtotal,taxesAndFees:n.roomTaxesAndFees,rawTaxesAndFees:n.rawRoomTaxesAndFees,rawTaxesAndFeesBreakdown:n.rawRoomTaxesAndFeesBreakdown,bookingPrice:Number(o),chargeTime:"PAS"===(null==n?void 0:n.paymentTimeframe)?"stay":"upfront",excludedTaxesAndFees:t.excludedTaxesAndFees,cashbackReward:r.cashbackReward||null,rawCashbackSubsidy:n.rawCashbackSubsidy||null,rawCashbackCommissionPool:n.rawCashbackCommissionPool||null}}function q(e,r){var{roomKey:n,shortDescription:o,longDescription:a,amenities:i,amenityInfo:l,refundable:u,cancellationDeadlinePretty:s,cancellationDeadlineTimePretty:c,cancellationPolicy:d,otherPolicy:m,paymentPolicy:p,defaultHotelPhoto:v,photos:g,modifiedFields:f,bookingClickToken:h,numRoomsAvailable:y,isUrgent:D,partnerRoomInfo:b,bedConfiguration:T}=e,{maxOccupancy:P}=r,I=$(e.priceUI);return{key:n,title:t(o),description:a,...I,partnerRoomInfo:b,amenities:i||[],mealPlanAmenities:l||[],refundablePolicy:u,cancellationDeadline:c||s,cancellationPolicy:d,otherPolicy:m,paymentPolicy:p,photos:g?K(null==g?void 0:g.map((e=>e.url))):[],defaultHotelPhoto:(null==v?void 0:v.url)||null,maxOccupancy:P,modifiedFields:f||[],bookingClickToken:h,numRoomsAvailable:y,isUrgent:D,rateVerification:null,bedConfiguration:T}}function H(e){var r=O(e.checkInDs),t=O(e.checkOutDs);return{checkInDate:I(r)?r:new Date,checkOutDate:I(t)?t:new Date,numberOfNights:e.nights,numberOfRooms:e.rooms,numberOfAdults:e.adults,numberOfChildren:e.totalChildren,geoName:e.geoName}}function V(e,r=!1){var n,o;return{name:t(null==e||null==(n=e.address)?void 0:n.name)||"",address:null==e||null==(o=e.address)?void 0:o.displayAddress,thumbnailUrl:null==e?void 0:e.thumbnailUrl,locationId:(null==e?void 0:e.locationId)||0,checkInOutPolicy:r?null==e?void 0:e.checkInOutPolicy:void 0}}function Y(e){return{partnerReservationId:null==e?void 0:e.partnerReservationId,reservationEmail:null==e?void 0:e.reservationEmail}}function Z(e){return{attractionsUrl:(null==e?void 0:e.attractionsUrl)||"",geoName:(null==e?void 0:e.geoName)||"",geoId:(null==e?void 0:e.geoId)||null}}function G(e,r,t){var n=!1;return setTimeout((()=>{n=!0}),12e4),new Promise((o=>{var a=()=>{(function(e,r,t){return fetch("/data/1.0/booking/status",{method:"POST",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-By":t},body:JSON.stringify({bookingId:e,accommodationId:r})})})(e,r,t).then((e=>e.json())).then((e=>{var r,t;e.is_complete?"SUCCEEDED"===e.state.toUpperCase()?o({success:!0,reservationId:e.reservation_id,isNewMember:(null==(r=e.member_info)?void 0:r.is_new_member)||!1,guestPasswordToken:(null==(t=e.member_info)?void 0:t.pw_guest_token)||null}):o({success:!1,reservationId:e.reservation_id,errors:e.booking_errors}):n?o({success:!1,reservationId:"",errors:[{isRecoverable:!1,translationString:"",problemName:"RequestTimeout",problemType:"Internal",fieldName:null}]}):setTimeout(a,2e3)}))};a()}))}function W(e){return"ROOM_SELECTION_UNAVAILABLE"===e||"AVAILABILITY_RESULT_UNAVAILABLE"===e}function X(e,r,t){var l,s,c,d,[m,p]=n({roomSelectionData:e,partnerData:r}),[v,g]=n(!1),f=u(),[h,y]=n(!1),[D,b]=n(null),T=o((null==m||null==(l=m.roomSelectionData)||null==(s=l.polling)?void 0:s.pollCount)||0),P=a((()=>{var{roomSelectionData:{polling:e}}=m;T.current+=1,y(!1),function(e,r){return fetch("/data/1.0/booking/detailedavailability",{method:"POST",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-By":r},body:JSON.stringify({...e,pollCount:e.pollCount+1})})}({...e,pollCount:T.current},f).then((e=>{if(e.ok)return e.json();throw new Error("Error while polling room selection")})).then((e=>{var r,{roomSelection:n,error:o}=e;o&&b(o);var{partnerInfos:a}=n||{},i=null==a?void 0:a.map((e=>{return{name:e.partner,hotel:V(null==e?void 0:e.hotel),rooms:(r=(null==e?void 0:e.roomList)||[],n=(null==e?void 0:e.roomTypes)||[],r.map((e=>q(e,n[e.roomTypeCode]||{})))||[]),coBrandingLogoUrl:t&&null!=e&&e.supportsPlusCoBranding?null==e?void 0:e.logoUrl:void 0,partnerTermsAndConditions:null==e?void 0:e.termsAndConditions,partnerPrivacyPolicy:null==e?void 0:e.privacyPolicy,isAgoda:(null==e?void 0:e.isAgoda)||!1};var r,n}));null!=n&&null!=(r=n.polling)&&r.complete||v?p({roomSelectionData:n,partnerData:i}):W(null==o?void 0:o.errorType)?y(!1):y(!0)})).catch((e=>{b(e)}))}),[t,T,v,m,f]),I=!(null==(c=m.roomSelectionData)||null==(d=c.polling)||!d.complete)||v||W(null==D?void 0:D.errorType);return i((()=>{if(h){var e=setTimeout(P,1e3);return()=>clearTimeout(e)}}),[P,h]),i((()=>{I||P()}),[]),i((()=>{var e=setTimeout((()=>g(!0)),2e4);return()=>clearTimeout(e)}),[]),[I,m,D]}var J=(e,r,t)=>{var n=c();return l((()=>{var o=e.flatMap((e=>e.rooms));if(!r||!t||!o.length)return o;var a=-1===t&&"BASE_RATE"===o[0].priceMode&&s("optimus_paywall"),i=n.formatCurrencyInteger(a?o[0].rawDisplayPrice:t),l=r.metaAmountSaved?n.formatCurrencyInteger(r.metaAmountSaved):void 0,u=r.metaStrikethroughPrice?n.formatCurrencyInteger(r.metaStrikethroughPrice):void 0;return o.map((e=>e.displayPrice===i?{...e,totalOptimusDiscount:l,referenceRateDisplayPrice:u}:e))}),[t,n,r,e])},Q="PlusBlockedRooms",ee=e=>{i((()=>{if(!e)return()=>{};var r=d.addListener("PlusBlockedRooms",((r,t)=>{t!==r&&e()}));return()=>{r()}}),[e]);var r=(e,r,t)=>({adults:e.numberOfAdults,children:e.numberOfChildren,rooms:e.numberOfRooms,checkIn:e.checkInDate.toDateString(),checkOut:e.checkOutDate.toDateString(),provider:t,roomKey:r});return{addBlockedRoom:a(((e,t,n)=>{if(n){var o=d.get(Q)||[];o.push(r(t,e,n)),d.set(Q,o,36e5)}}),[]),filterBlockedRooms:a(((e,t,n)=>{if(!n)return e;var o=d.get(Q);return o?e.filter((e=>!o.some((o=>{return a=o,i=r(t,e.key,n),a.adults===i.adults&&a.children===i.children&&a.rooms===i.rooms&&a.checkIn===i.checkIn&&a.checkOut===i.checkOut&&a.roomKey===i.roomKey&&a.provider===i.provider;var a,i})))):e}),[])}},re="PlusRefreshRooms",te=(e,r)=>(i((()=>{if(!r||!e)return()=>{};var t=d.addListener(re,((t,n)=>{t&&n!==t&&t.some((r=>{return n=r,(t=e).geoName===n.geoName&&t.numberOfRooms===n.numberOfRooms&&t.numberOfNights===n.numberOfNights&&t.numberOfAdults===n.numberOfAdults&&t.numberOfChildren===n.numberOfChildren;var t,n}))&&r()}));return()=>{t()}}),[r,e]),{refreshRoomList:a((e=>{var r=d.get(re)||[];r.push(e),d.set(re,r,3e4)}),[])}),ne=(e,r)=>{var t;if(r)return[{name:"BAD_API_RESPONSE",type:"Internal",message:r}];if(!e||!Object.keys(e).length)return[{name:"BAD_API_RESPONSE",message:"No data returned in the response",type:"Internal"}];if(null!=(t=e.error)&&t.errorType)return[{name:"BAD_API_RESPONSE",message:e.error.errorType,type:"Internal"}];var{bookingSessionId:n,roomSelection:o,bookingContext:a,optimusSubscriptionPrice:i}=e,l=[];if(n||l.push({name:"INVALID_BOOKING_ID",message:"Booking Session Id empty",type:"Internal"}),i||l.push({name:"INVALID_SUBSCRIPTION_PRICE",message:"No subscription price information returned in the response",type:"Internal"}),!a)return l.push({name:"NO_BOOKING_CONTEXT",message:"No booking context returned in the response",type:"Internal"}),l;if(!o){var{hotelOverviewUrl:u}=a;l.push({name:"INVALID_ROOM_SELECTION",message:"No room selection data returned in the response",type:"Internal",...u&&{redirectUrl:u}})}return l.length>0?l:null},oe=({loading:e,data:r,error:t,children:n})=>{var o=l((()=>{var n=e?null:D(r,t),o=e||n||!r?null:function(e){var{bookingSessionId:r,bookingContext:{vaultUrl:t,countries:n,isSecurelyLoggedIn:o,hotelReviewUrl:a,hotelOverviewUrl:i,originalMetaPrice:l},roomSelection:u,roomSelection:{partnerInfos:s,trackingContext:c,summary:d,polling:{selectedRoomKey:m}},optimusSubscriptionPrice:p,optimusSavings:v,optimusBranding:g,isPlusIB:f}=e;return{bookingSessionId:r,checkoutSession:{vaultUrl:t,isSecurelyLoggedIn:o},partnerData:null==s?void 0:s.map((e=>{return{name:e.partner,hotel:V(null==e?void 0:e.hotel,f&&!(null==e||!e.showCheckInOutPolicy)),rooms:(r=(null==e?void 0:e.roomList)||[],t=(null==e?void 0:e.roomTypes)||[],r.map((e=>q(e,t[e.roomTypeCode]||{})))||[]),coBrandingLogoUrl:f&&null!=e&&e.supportsPlusCoBranding?null==e?void 0:e.logoUrl:void 0,privacyPolicyList:f&&null!=e&&e.showPrivacyPolicy?null==e?void 0:e.privacyPolicyList:void 0,partnerTermsAndConditions:null==e?void 0:e.termsAndConditions,partnerPrivacyPolicy:null==e?void 0:e.privacyPolicy,acceptedCreditCardTypes:null==e?void 0:e.acceptedCreditCardTypes,isAgoda:(null==e?void 0:e.isAgoda)||!1};var r,t})),trackingContext:c,roomSelectionSummary:H(d),countries:n,roomSelectionData:u,optimusSubscriptionPrice:p,bookingAdditionalContext:{hotelReviewUrl:a,hotelOverviewUrl:i,originalMetaPrice:l},optimusSavings:v,selectedRoomKey:m,optimusBranding:g,isCashback:f}}(r);return{loading:e,errors:n,bookingData:o}}),[e,r,t]),a=!e&&r?r.diagnostics:null;return p(v,{children:[n(o),a&&g("div",{hidden:!0,id:"__diagnostics__",children:a})]})};return e({mapHotelData:V,mapReservationData:Y,mapReservationGeoData:Z,mapRoomData:q,mapRoomPriceInfo:$,mapRoomSelectionSummaryData:H,pollBookingConfirmation:G,useRoomSelectionPolling:X}),[()=>{f=J,h=ee,y=te,D=ne,b=m(((e,r)=>{var t=new URLSearchParams,n=Object.keys(e.route).filter((e=>"src"!==e));n.sort(),n.forEach((r=>{var n=e.route[r];n&&t.set(r,n)})),t.append("isTaMember",e.auth.isMember?"true":"false"),t.has("sar")||t.append("sar","true");var o=r(`/data/1.0/booking/rooms?${t.toString()}`);return()=>{var{data:e=null,loading:r=!1,error:t=null}=o.get();return{loading:r,error:t,data:e}}}))(oe),e({HotelCheckoutParsedDataSupplier:oe,default:b,mapHotelData:V,mapReservationData:Y,mapReservationGeoData:Z,mapRoomData:q,mapRoomPriceInfo:$,mapRoomSelectionSummaryData:H,pollBookingConfirmation:G,useBlockedRooms:h,useRefreshRooms:y,useRoomSelectionPolling:X,useRoomsWithPatchedSavings:f})},[e=>t=e.unescapeHtml,e=>(n=e.useState,o=e.useRef,a=e.useCallback,i=e.useEffect,l=e.useMemo),e=>u=e.useSecurityToken,e=>s=e.featureIsEnabled,e=>c=e.useIntlFormatter,e=>d=e.default,e=>m=e.bind,e=>(p=e.jsxs,v=e.Fragment,g=e.jsx)]]},["irfizf","1o4yt4","ahlu9q","skjzuv","17thqz","19b9b1","16z5q2","121h32"]]);
