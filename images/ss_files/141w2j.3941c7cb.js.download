(this.$WP=this.$WP||[]).push(["141w2j",(e,i)=>{"use strict";var t,s,r,o,n,a,d,_,l=(e,i,t)=>{fetch("/data/1.0/tap/recordEvent",{method:"POST",headers:{"content-type":"application/json","x-requested-by":window.JS_SECURITY_TOKEN},credentials:"same-origin",body:JSON.stringify({eventType:t,requestGuid:e,externalId:i})}).then((e=>(e.ok||console.error(`Did not get an ok. got: ${e.statusText}`),e))).catch((e=>{console.error(`Error sending TripAds click event: ${e.message}`)}))},c=(e,i)=>{l(e,i,"CLICKED")},p=(e,i)=>{l(e,i,"CLICKED_UNPAID")},g=(e,i)=>{l(e,i,"IMPRESSED")},m=(e,i,t,s,r)=>{var{sponsoredListing:n}=e,a={};n&&(a={placement_slot_name:n.placement_slot_name,location_id:e.id,sponsored_type:n.sponsored_type,opportunity_uid:n.opportunity_uid,sl_line_item_id:n.sl_line_item_id,page_geo_id:i,chosen_location_id:e.id,listing_key:e.listingKey,trip_ads_select_guid:n.trip_ads_select_request_guid,trip_ads_id:n.trip_ads_id}),o(t,s,{...a,...r})},u=(e,{auth:i,meta:t},s)=>{var{sponsoredListing:o}=e;if(o){var n={is_member:i.isMember,device_type:t.device.userAgentCategory?t.device.userAgentCategory.toLowerCase():"",locationId:e.id,slot:o.placement_slot_name,trip_ads_select_guid:o.trip_ads_select_request_guid,listing_key:e.listingKey};r(s,n)}},k=(e,i)=>{e.trip_ads_select_request_guid&&i(e.trip_ads_select_request_guid,e.opportunity_uid||"")},v="SP_PARTNER_NOTIFICATION_IFRAME",E=e=>{if(e){var i=document.getElementById(v);i||((i=document.createElement("iframe")).setAttribute("id",v),i.setAttribute("style","position: absolute; visibility: hidden; right: 0; bottom: 0; width: 1px; height: 1px"),a(d.ALL,(()=>{document.body&&i&&document.body.appendChild(i)}))),i.src=e}},y=(e,{route:i},t,s,r,o)=>{var{sponsoredListing:n}=e;if(n){var a={area:n.placement_slot_name,click_type:t,dest:s,from:i.page,impression_key:n.impression_key,is_backfill:!0,listing_key:e.listingKey,location_id:e.id,sl_line_item_id:n.sl_line_item_id,trip_ads_id:n.trip_ads_id,tt_placement:n.tt_placement,auction_offer_key:r,gosox:n.gosox};fetch(o?"/SponsoredListingCommerce/1.0/increment_click_metric":"/SponsoredListingCommerce/1.0/click",{method:"POST",headers:{"content-type":"application/json","x-requested-by":window.JS_SECURITY_TOKEN},credentials:"same-origin",body:JSON.stringify(a)}).then((e=>(e.ok||e.statusText,e))).catch((e=>{console.error(`Error sending commerce click: ${e.message}`)}))}};return[()=>{e("SponsoredListingTrackingEventHandlers",_=class{constructor(){this.visibleHandledHotels=new Set}clickHandler(e){var{sponsoredListing:i}=e;if(i){var r=n().getState();((e,i)=>{var{sponsoredListing:t}=e;t&&m(e,i,"action","paid_backup_sponsored_listing_click",{ik:t.impression_key,tt_placement:t.tt_placement})})(e,r.page.geoId),u(e,r,s.HOTELS_SP_CLICK),(e=>{var i=new Date;i.setTime(i.getTime()+1e4);var s={expires:i};t.set("sponsOppId",e.opportunity_uid,s),t.set("sponsLineItem",e.sl_line_item_id,s)})(i),y(e,r,"HR","Hotel_Review",null,!1),E(i.partner_notification_url),k(i,c)}}visibleHandler(e){var{sponsoredListing:i}=e;if(i&&!this.visibleHandledHotels.has(e.id)){this.visibleHandledHotels.add(e.id);var t=n().getState();((e,i)=>{m(e,i,"impression","paid_backup_sponsored_listing_displayed",{})})(e,t.page.geoId),u(e,t,s.HOTELS_SP_IMPRESSION),E(i.partner_impression_notification_url),k(i,g)}}clearVisibleHistory(){this.visibleHandledHotels.clear()}offerClickHandler(e,i){var{sponsoredListing:t}=e;if(t){var s=n().getState();((e,i,t)=>{var s=i.isInstantBook?"paid_backup_sponsored_ib_click":"paid_backup_sponsored_meta_click";globalThis.require&&window.require(["trjs!commerce/offerclick"],(r=>{var{url:o,...n}=r.expandToken(i.offerClickToken);m(e,t,"action",s,n)}))})(e,i,s.page.geoId);var r=((e,i)=>{if(globalThis.require){var{slot:t}=window.require("trjs!commerce/offerclick").expandToken(i.offerClickToken);return!!e&&"DISCOVERY_META_PREFERENCE"===e.sponsored_type&&"1"===t}return!1})(t,i),o="DISCOVERY_META_PREFERENCE"!==t.sponsored_type||r,a=(e=>{if(globalThis.require){var{ttAOK:i}=window.require("trjs!commerce/offerclick").expandToken(e.offerClickToken);return i}return""})(i);o&&y(e,s,i.isInstantBook?"IB":"META",i.provider,a,r),k(t,o?c:p)}}}),e({SponsoredListingTrackingEventHandlers:_,logTripAdsClickEvent:c,logTripAdsClickUnpaidEvent:p,logTripAdsImpressionEvent:g,notifyPartner:E})},[e=>t=e.default,e=>(s=e.holisticEvents,r=e.trackHolisticEvent,o=e.trackEventWithContext),e=>n=e.getStore,e=>(a=e.requestConsent,d=e.CategoriesEnum)]]},["5gpqhx","4axon3","45ddp0","1973cc"]]);
