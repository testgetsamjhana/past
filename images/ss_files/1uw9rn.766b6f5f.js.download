(this.$WP=this.$WP||[]).push(["1uw9rn",(e,r)=>{"use strict";var l,t,i,u,n,d,a,p,o,s,T,v,c,I,m=e=>{var[,r]=p(u),[,l]=p(n),[i,d]=t({fetching:!1}),a=s("SAVE_TO_TRIP"),T=Number(null==e?void 0:e.id),v="gaiTrip"===(null==e?void 0:e.type),c="publicTripBundle"===(null==e?void 0:e.type),I=v?"COPY_TRIP":"ADD_ITEM_TO_TRIP";return e?[i,async t=>{d({fetching:!0});try{var i,u;if(v||c){if(!isNaN(T)){var n,p,s,m,h,y,f=await l({copyComments:!1,tripId:T,targetTripId:t});i={id:null!=(n=null==f||null==(p=f.data)||null==(s=p.Trips_copyTrip)?void 0:s.tripId)?n:0,__typename:"Trip"},u=null==f||null==(m=f.data)||null==(h=m.Trips_copyTrip)||null==(y=h.errors)?void 0:y[0]}}else{var g,_,E,P,R,b,q=await r({tripId:t,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1});i=null==q||null==(g=q.data)||null==(_=g.addItemToTrip)?void 0:_.trip,u=null==q||null==(E=q.data)||null==(P=E.addItemToTrip)||null==(R=P.errors)||null==(b=R[0])?void 0:b.error}return((r,l)=>{if(r){var t=o(r,e);t?(a(),d({fetching:!1,result:{trip:r,tripItem:t}})):["bundleSave","gaiTrip","publicTripBundle"].includes(e.type)?d({fetching:!1,result:{trip:r,tripItem:{__typename:"TripItem",id:0,comments:[]}}}):d({fetching:!1,error:{query:I,tripsError:null!=l?l:void 0}})}else d({fetching:!1,error:{query:I,tripsError:null!=l?l:void 0}})})(i,u),[i,u]}catch(e){return console.error(e),d({fetching:!1,error:{query:I}}),[null,null]}}]:[i,()=>Promise.resolve([null,null])]},h="mostRecentlyAddedToTrip",y=e=>{var r=T.get(h);return r&&r.userId===e?r.tripId:null},f=(e,r,l,t)=>{var[u,n]=c(r),d=v();return[u,i((()=>{var i=null!=e?e:y(d);return l||!i||null!=(null==r?void 0:r.type)&&I.has(r.type)?(t&&t(),Promise.resolve([null,null])):n(i)}),[l,r,t,n,d,e]),e=>((e,r)=>{r?T.set(h,{tripId:e,userId:r},144e5):T.remove(h)})(e,d)]},g=(e,r,t)=>{var[i,u]=l.useState({fetching:!1,saved:!!t}),[,n]=p(d),[,o]=p(a);return[i,t?()=>t?(u({...i,fetching:!0}),o({itemId:t.id,tripId:r}).then((e=>{var r,l=null==e||null==(r=e.data)?void 0:r.tripsRemoveItem;return l?(u({fetching:!1,saved:!1,result:{trip:l}}),i):(u({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),i)})).catch((()=>(u({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),i)))):Promise.resolve(i):()=>(u({...i,fetching:!0}),n({tripId:r,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1}).then((e=>{var r,l,t,n,d,a,p,o,s,T=null==e||null==(r=e.data)||null==(l=r.addItemToTrip)?void 0:l.trip,v=null==e||null==(t=e.data)||null==(n=t.addItemToTrip)||null==(d=n.errors)||null==(a=d[0])?void 0:a.error;if(v||!T)return u({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:v||void 0}}),i;var c=null==e||null==(p=e.data)||null==(o=p.addItemToTrip)||null==(s=o.items)?void 0:s[0];return u(c?{fetching:!1,saved:!0,result:{trip:T,tripItem:c}}:{fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i})).catch((()=>(u({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i))))]};return[()=>{c=m,I=new Set(["savesItem","bundleSave","gaiTrip","publicTripBundle"]),e({getMostRecentlyAddedToTrip:y,useAutosave:f,useSave:c,useTripSaveToggle:g})},[e=>(l=e,t=e.useState,i=e.useCallback),e=>(u=e.AddItemToTrip,n=e.TripsCopyTrip,d=e.AddItemWithFullTrip,a=e.RemoveItemWithFullTrip),e=>p=e.useMutation,e=>o=e.getItemByReference,e=>s=e.usePixelCallback,e=>T=e.default,e=>v=e.useUserId]]},["1o4yt4","ag9b0s","1mqwhq","1iyqcw","1emwhd","19b9b1","52far5"]]);
